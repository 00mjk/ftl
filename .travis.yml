dist: bionic
sudo: false

language: c++

compiler:
    - gcc

addons:
    coverity_scan:
        project:
            name: "janweinstock/ftl"
            description: "An x86 code generator library for dynamic binary translation"
        notification_email: "jan.weinstock@rwth-aachen.de"
        build_command: "make"
        branch_pattern: "coverity"

env:
    global:
        - secure: "M9LvhMh0Jw5yyN0zLHoPxbhxh7i5FCmwphD1TOKG9KRgSUedVEExA6+VGi4nYc63yTPeQFPDKFKw/QSAg6rIdIrjxj6qILvn2l2VRHdT12MAJXViBUHC5Rm4p0h2t59SBPfd1VXWYXPQwNDfzRQUPj/YzFQQdMjQvvxafX71y6GdoI/oj97WGwhdAHslxqXaexSn7shmfo8mux9gHkGNDQQmeqLK+x6xMo/db0zbwzG3RoeqJdSe5MXZxGokj0l+La5aFdefxc9S2li+N/pXc+h0rUNKXJGDR++awYw3wZNOmy/PtTSxKsL+5abXkTe54KJAHARD/m2VFVbNEV564NQLwFz0YHXKoow2L0VK9gCXp2xdHWno27FL5gpFnp+zTM5c0iPeS7DwWSDGOL31wse5m6GVdBfZmQZYZbVNRUr1XloRy2VU6hty58wbbycRI79SGu9GfHabGtTzPPwMfeYFUHSkxHc3H5Mkurpc9f2gOALNhW3w+FvwVS0M/1OxW35tvGrCTUhHfcbJesqxjW/a11/+yVzWsh9vQrAha8GvNmZHd2a+yVr/6GD7jciQsbQTXMBVITgHYJkBQqf+dBvqvfaOYFiLIEwzqPZlXYIKulIswhNHf8qQhTXrgtsGvZo0Bt/B/rkK+i7ZvhEnS9KUbPNNxduw7wRADFNrKD4="
    jobs:
        - BUILD=DEBUG
        - BUILD=RELEASE

before_script:
    - mkdir -p BUILD/$BUILD/BUILD && cd BUILD/$BUILD/BUILD
    - |
        cmake -DCMAKE_BUILD_TYPE=$BUILD \
              -DCMAKE_INSTALL_PREFIX=.. \
              -DFTL_BUILD_TESTS=ON      \
              -DFTL_BUILD_EXAMPLES=ON   \
              ../../..

script:
    - make -j 4 && ctest --output-on-failure

